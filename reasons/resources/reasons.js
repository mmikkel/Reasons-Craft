!function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return e[i].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var s=n(1),a=i(s);Craft.ReasonsPlugin=new a["default"]},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function s(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(2),r=s(l);n(3),n(7);var d=n(9),u=i(d),c=n(10),f=s(c),p=n(13),h=s(p),g=n(15),v=s(g),y=n(16),T=(s(y),function(){function e(){a(this,e)}return o(e,[{key:"init",value:function(t){e.data=t;var n={FieldLayoutDesigner:f["default"],MatrixConfigurator:h["default"]};for(var i in n){var s=n[i],a=r["default"][i]||null;a&&new s(a)}$(this.initParser.bind(this)),console.info("Reasons init",e.data)}},{key:"initParser",value:function(){this.destroyParser();var t=e.getFormAttributes();return t.context===u.PARSER_CONTEXT&&void(t.conditionals&&(this.parser=new v["default"]($form,t.conditionals)))}},{key:"destroyParser",value:function(){this.parser&&(this.parser.destroy(),delete this.parser)}}],[{key:"getConditionals",value:function(t){return t?e.data.conditionals&&e.data.conditionals.hasOwnProperty(t)?e.data.conditionals[t]:null:e.data.conditionals||{}}},{key:"getConditionalContextFromAttributes",value:function(e){return e.type+(e.id?":"+e.id:"")}},{key:"getToggleFields",value:function(){return e.data.toggleFields?e.data.toggleFields:[]}},{key:"getToggleFieldById",value:function(t){t=parseInt(t);for(var n=e.getToggleFields(),i=n.length,s=0;s<i;++s)if(parseInt(n[s].id)===t)return n[s];return!1}},{key:"getFieldIds",value:function(){return e.data.fieldIds?e.data.fieldIds:{}}},{key:"getFieldIdByHandle",value:function(t){var n=e.getFieldIds();return!(!n||!n.hasOwnProperty(t))&&n[t]}},{key:"getToggleFieldTypes",value:function(){return e.data.toggleFieldTypes?e.data.toggleFieldTypes:[]}},{key:"getFormAttributes",value:function(t){if(!t&&(t=r["default"].cp.$primaryForm&&r["default"].cp.$primaryForm.length?r["default"].cp.$primaryForm:$("#content form:first"),!t||!t.length))return!1;if(t.data("elementEditor"))return!1;var n=t.find('input[type="hidden"][name="namespace"]').val();n&&(n+="-");var i=t.find('input[type="hidden"][name="action"]').val(),s=void 0,a=void 0;switch(i){case u.ASSET_SOURCE_ACTION:s=u.ASSET_SOURCE_HANDLE,a='input[type="hidden"][name="sourceId"]';break;case u.CATEGORY_ACTION:case u.CATEGORY_GROUP_ACTION:s=u.CATEGORY_GROUP_HANDLE,a='input[type="hidden"][name="groupId"]';break;case u.GLOBAL_SET_CONTENT_ACTION:case u.GLOBAL_SET_ACTION:s=u.GLOBAL_SET_HANDLE,a='input[type="hidden"][name="setId"]';break;case u.ENTRY_ACTION:var o=t.find('select#entryType, input[type="hidden"][name="entryTypeId"], input[type="hidden"][name="typeId"], #'+n+"entryType");s=o.length?u.ENTRY_TYPE_HANDLE:u.SECTION_HANDLE,a=o.length?'select#entryType, input[type="hidden"][name="entryTypeId"], input[type="hidden"][name="typeId"], #'+n+"entryType":'input[type="hidden"][name="sectionId"], #'+n+"section";break;case u.ENTRY_TYPE_ACTION:s=u.ENTRY_TYPE_HANDLE,a='input[type="hidden"][name="entryTypeId"]';break;case u.TAG_ACTION:case u.TAG_GROUP_ACTION:s=u.TAG_GROUP_HANDLE,a='input[type="hidden"][name="tagGroupId"], input[type="hidden"][name="groupId"]';break;case u.USERS_ACTION:case u.USERS_FIELDS_ACTION:s=u.USERS_HANDLE;break;case u.FIELDS_ACTION:s=u.FIELDS_HANDLE,a='input[type="hidden"][name="fieldId"]';break;case u.SOLSPACE_CALENDAR_SETTINGS_ACTION:case u.SOLSPACE_CALENDAR_EVENTS_ACTION:s=u.SOLSPACE_CALENDAR_HANDLE;break;case u.COMMERCE_PRODUCT_TYPE_ACTION:case u.COMMERCE_PRODUCT_ACTION:s=u.COMMERCE_PRODUCT_TYPE_HANDLE,a='input[type="hidden"][name="typeId"]'}if(!s)return!1;var l={type:s,context:e.getFormContext(t),id:!!a&&0|t.find(a).val()},d=e.getConditionalContextFromAttributes(l);return l.conditionals=e.getConditionals(d),l}},{key:"getFormContext",value:function(e){if(e.data("elementEditor"))return!1;var t=e.find('input[type="hidden"][name="action"]').val();switch(t){case u.GLOBAL_SET_CONTENT_ACTION:case u.ENTRY_ACTION:case u.TAG_ACTION:case u.CATEGORY_ACTION:case u.USERS_ACTION:case u.SOLSPACE_CALENDAR_EVENTS_ACTION:case u.COMMERCE_PRODUCT_ACTION:return u.FORM_PARSER_CONTEXT;case u.ASSET_SOURCE_ACTION:case u.CATEGORY_GROUP_ACTION:case u.GLOBAL_SET_ACTION:case u.ENTRY_TYPE_ACTION:case u.TAG_GROUP_ACTION:case u.USERS_FIELDS_ACTION:case u.SOLSPACE_CALENDAR_SETTINGS_ACTION:case u.COMMERCE_PRODUCT_TYPE_ACTION:return u.FIELD_LAYOUT_DESIGNER_CONTEXT}return!1}}]),e}());T.data=null,t["default"]=T},function(e,t){e.exports=Craft},function(e,t,n){var i=n(4);"string"==typeof i&&(i=[[e.id,i,""]]);n(6)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(5)(),t.push([e.id,".field.reasonsHide{height:0!important;visibility:hidden!important;overflow:hidden!important;pointer-events:none!important;margin:0!important;padding:0!important;position:absolute!important}.reasonsModal .body{overflow:auto}.reasonsBuilderUi .heading{margin-bottom:20px;font-weight:700}.reasonsBuilderUi.disabled{opacity:1}.reasonsBuilderUi.disabled .wrapper{display:none}.reasonsMessage{color:#8f98a3}.reasonsBuilder,.reasonsStatement{width:100%;float:left}.reasonsStatement{margin-bottom:20px;padding-bottom:18px;border-bottom:1px solid #ccc;position:relative}.reasonsStatement .delimiter{display:inline-block;position:absolute;left:20px;bottom:-6px;padding:0 6px;background-color:#fff;line-height:1;font-size:10px;font-weight:700;color:#999;text-transform:uppercase}.reasonsRuleParams,.reasonsRuleParams>*{display:inline-block;width:auto;float:left;position:relative;margin:0 10px 10px 0}.reasonsRuleParams{margin:0}.reasonsRule{width:100%;float:left;clear:both;margin-right:0}.reasonsRuleLead{display:block;line-height:1;font-size:12px;color:#999;float:left;clear:both;margin-bottom:8px}.reasonsAddRule,.reasonsRemoveRule{display:inline-block;margin:6px 2px}.reasonsAddRule{display:none;margin-left:5px;margin-top:0;float:left;clear:both}.reasonsRule:last-child .reasonsAddRule{display:inline-block}.reasonsRule:last-child .reasonsRuleLead{display:none}.reasonsAdd{width:100%;float:left}.fld-field.js-reasons-has-conditionals{border-style:dashed}.matrix-configurator .reasonsAdd{display:inline-block;float:none;width:auto;margin-right:10px}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},s=0;s<this.length;s++){var a=this[s][0];"number"==typeof a&&(i[a]=!0)}for(s=0;s<t.length;s++){var o=t[s];"number"==typeof o[0]&&i[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),e.push(o))}},e}},function(e,t,n){function i(e,t){for(var n=0;n<e.length;n++){var i=e[n],s=p[i.id];if(s){s.refs++;for(var a=0;a<s.parts.length;a++)s.parts[a](i.parts[a]);for(;a<i.parts.length;a++)s.parts.push(d(i.parts[a],t))}else{for(var o=[],a=0;a<i.parts.length;a++)o.push(d(i.parts[a],t));p[i.id]={id:i.id,refs:1,parts:o}}}}function s(e){for(var t=[],n={},i=0;i<e.length;i++){var s=e[i],a=s[0],o=s[1],l=s[2],r=s[3],d={css:o,media:l,sourceMap:r};n[a]?n[a].parts.push(d):t.push(n[a]={id:a,parts:[d]})}return t}function a(e,t){var n=v(),i=m[m.length-1];if("top"===e.insertAt)i?i.nextSibling?n.insertBefore(t,i.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),m.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function o(e){e.parentNode.removeChild(e);var t=m.indexOf(e);t>=0&&m.splice(t,1)}function l(e){var t=document.createElement("style");return t.type="text/css",a(e,t),t}function r(e){var t=document.createElement("link");return t.rel="stylesheet",a(e,t),t}function d(e,t){var n,i,s;if(t.singleton){var a=T++;n=y||(y=l(t)),i=u.bind(null,n,a,!1),s=u.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=r(t),i=f.bind(null,n),s=function(){o(n),n.href&&URL.revokeObjectURL(n.href)}):(n=l(t),i=c.bind(null,n),s=function(){o(n)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else s()}}function u(e,t,n,i){var s=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=C(t,s);else{var a=document.createTextNode(s),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function c(e,t){var n=t.css,i=t.media;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function f(e,t){var n=t.css,i=t.sourceMap;i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var s=new Blob([n],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}var p={},h=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},g=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=h(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,T=0,m=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=g()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=s(e);return i(n,t),function(e){for(var a=[],o=0;o<n.length;o++){var l=n[o],r=p[l.id];r.refs--,a.push(r)}if(e){var d=s(e);i(d,t)}for(var o=0;o<a.length;o++){var r=a[o];if(0===r.refs){for(var u=0;u<r.parts.length;u++)r.parts[u]();delete p[r.id]}}}};var C=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var s=n(8),a=i(s);/*!
	 * jQuery.fn.hasAttr()
	 *
	 * Copyright 2011, Rick Waldron
	 * Licensed under MIT license.
	 *
	 */
!function(e){e.fn.hasAttr=function(e){for(var t=0,n=this.length;t<n;t++)if(void 0!==this.attr(e))return!0;return!1}}(a["default"])},function(e,t){e.exports=jQuery},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ASSET_SOURCE_HANDLE="assetSource",t.CATEGORY_GROUP_HANDLE="categoryGroup",t.TAG_GROUP_HANDLE="tagGroup",t.GLOBAL_SET_HANDLE="globalSet",t.ENTRY_TYPE_HANDLE="entryType",t.SECTION_HANDLE="section",t.USERS_HANDLE="users",t.FIELDS_HANDLE="field",t.SOLSPACE_CALENDAR_HANDLE="solspaceCalendar",t.ASSET_SOURCE_ACTION="assetSources/saveSource",t.CATEGORY_ACTION="categories/saveCategory",t.CATEGORY_GROUP_ACTION="categories/saveGroup",t.TAG_ACTION="tagManager/saveTag",t.TAG_GROUP_ACTION="tags/saveTagGroup",t.GLOBAL_SET_CONTENT_ACTION="globals/saveContent",t.GLOBAL_SET_ACTION="globals/saveSet",t.ENTRY_ACTION="entries/saveEntry",t.ENTRY_TYPE_ACTION="sections/saveEntryType",t.USERS_ACTION="users/saveUser",t.USERS_FIELDS_ACTION="users/saveFieldLayout",t.FIELDS_ACTION="fields/saveField",t.SOLSPACE_CALENDAR_EVENTS_ACTION="calendar/events/saveEvent",t.SOLSPACE_CALENDAR_SETTINGS_ACTION="calendar/settings/saveSettings",t.FIELD_LAYOUT_DESIGNER_CONTEXT="FIELD_LAYOUT_DESIGNER_CONTEXT",t.MATRIX_CONFIGURATOR_CONTEXT="MATRIX_CONFIGURATOR_CONTEXT",t.FORM_PARSER_CONTEXT="FORM_PARSER_CONTEXT",t.MATRIX_PARSER_CONTEXT="MATRIX_PARSER_CONTEXT"},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(1),l=i(o),r=n(11),d=i(r),u=n(12),c=i(u),f=function(){function e(t){s(this,e);var n=t.prototype,i=t.FieldDrag.prototype,a=this,o=n.init;n.init=function(){o.apply(this,arguments),a.init(this)};var l=n.initField;n.initField=function(e){l.apply(this,arguments);var t=e.find(".settings").data("menubtn").menu||null,n=t&&t.$container?t.$container.find('a[data-action="remove"]').parent():null,i=$('<li><a data-action="toggle-reasons">'+Craft.t("Edit conditionals")+"</a></li>");n&&n.length&&i.insertBefore(n).find("a").data("menu",t).on("click",a.onReasonsToggleOptionSelect.bind(a)),a.update()};var r=n.removeFieldById;n.removeFieldById=function(e){var t=this.$allFields.filter("[data-id="+e+"]:first");t&&t.length&&t.data("_reasonsPlugin")&&(t.data("_reasonsPlugin").destroy(),t.data("_reasonsPlugin",null)),r.apply(this,arguments),a.update()};var d=i.onDragStop;i.onDragStop=function(){d.apply(this,arguments),a.update()}}return a(e,[{key:"init",value:function(e){var t=l["default"].getFormAttributes();return!!t&&(this.fld=e,this.$input=$('<input type="hidden" name="_reasonsPlugin" value="" />').appendTo(this.fld.$container),this.setConditionals(t.conditionals),void this.update())}},{key:"toggleModal",value:function(e){var t=this;new c["default"](e.data("_reasonsPlugin"),{onHide:function(){t.onBuilderModalHide(this)}})}},{key:"update",value:function(){if(!this.fld)return!1;var e=this,t={},n=void 0,i=void 0,s=void 0,a=void 0,o=void 0,r=void 0;this.fld.$tabContainer.children().each(function(){n=$(this),s=n.children(".fld-tabcontent").children(),o=[],s.each(function(){r=l["default"].getToggleFieldById($(this).data("id")),r&&o.push(r)}),s.each(function(){i=$(this),a=i.data("id"),i.data("_reasonsPlugin")?i.data("_reasonsPlugin").update({toggleFields:o}):i.data("_reasonsPlugin",new d["default"]({fieldId:a,toggleFields:o,rules:e.getConditionals(a)}));var n=i.data("_reasonsPlugin").getConditionals();n?(t[a]=n,i.addClass("js-reasons-has-conditionals")):i.removeClass("js-reasons-has-conditionals")})}),this.setConditionals(t)}},{key:"getConditionals",value:function(e){return e?this.conditionals&&this.conditionals.hasOwnProperty(e)?this.conditionals[e]:null:this.conditionals||null}},{key:"setConditionals",value:function(e){this.conditionals=e,this.conditionals&&0!==Object.keys(this.conditionals).length?this.$input.attr("value",JSON.stringify(this.conditionals)):this.$input.attr("value","")}},{key:"onBuilderModalHide",value:function(e){this.update()}},{key:"onReasonsToggleOptionSelect",value:function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget,n=$(t).data("menu"),i=n.$anchor.parent();n.hide(),this.toggleModal(i)}}]),e}();t["default"]=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(1),l=(i(o),function(){function e(t){if(s(this,e),this.setSettings(t),this.fieldId=this.settings.fieldId,this.$container=$(e.templates.builderUi()),this.$ui=this.$container.find(".reasonsBuilder:first"),this.$rule=this.$container.find(".reasonsRule:first").clone(!0),this.$statement=this.$container.find(".reasonsStatement:first").clone(!0),this.$statement.find(".reasonsRule").remove(),this.$message=this.$container.find(".reasonsMessage:first"),this.$container.on("click",".reasonsAddRule",this.onAddRuleBtnClick.bind(this)).on("click",".reasonsRemoveRule",this.onRemoveRuleBtnClick.bind(this)).on("click",".reasonsAddStatement",this.onAddStatementBtnClick.bind(this)).on("change",".reasonsRuleToggleField select",this.onRuleToggleFieldChange.bind(this)).on("change",".reasonsRuleCompare select",this.onRuleCompareChange.bind(this)).on("change",".reasonsRuleValue *:input",this.onRuleValueChange.bind(this)),this.$ui.html(""),this.settings.toggleFields&&this.setToggleFields(this.settings.toggleFields),this.settings.rules&&this.settings.rules.length>0)for(var n=0;n<this.settings.rules.length;++n)this.addStatement({rules:this.settings.rules[n]});this.render()}return a(e,[{key:"setSettings",value:function(t){this.settings=$.extend({},this.settings||e.settings,t)}},{key:"destroy",value:function(){this.$container.off("click change"),delete this.$container,delete this.$ui,delete this.$statement,delete this.$message,delete this.settings,delete this.fieldId}},{key:"get",value:function(){return this.$container}},{key:"disable",value:function(){this.$container.addClass("disabled")}},{key:"enable",value:function(){this.$container.removeClass("disabled")}},{key:"update",value:function(e){this.setSettings(e),this.setToggleFields(this.settings.toggleFields),this.render()}},{key:"setToggleFields",value:function(t){if(!t)return!1;this.settings.toggleFields=[],this.settings.toggleFieldIds=[],this.settings.toggleFieldsByIds={};for(var n=0;n<t.length;++n)t[n].id!=this.fieldId&&(this.settings.toggleFields.push(t[n]),this.settings.toggleFieldIds.push(t[n].id),this.settings.toggleFieldsByIds[t[n].id]=t[n]);for(var i="",n=0;n<this.settings.toggleFields.length;++n)i+=e.templates.toggleSelectOption(this.settings.toggleFields[n]);this.$rule.find(".reasonsRuleToggleField select").html(i)}},{key:"getToggleFieldById",value:function(e){return this.settings.toggleFieldsByIds&&this.settings.toggleFieldsByIds[e]?this.settings.toggleFieldsByIds[e]:null}},{key:"render",value:function(){this.settings.rules=[];var t=this.settings.toggleFields||[];if(0===t.length)return this.disable(),this.$message.text(Craft.t("No toggle fields available.")),!1;this.enable(),this.$message.text("");var n,i,s,a,o,l,r,d=this,u=this.$container.find(".reasonsStatement");u.each(function(){return n=[],i=$(this),s=i.find(".reasonsRule"),s.each(function(){if(a=$(this),o=a.find(".reasonsRuleToggleField select"),l=parseInt(o.val()),d.settings.toggleFieldIds.indexOf(l)===-1)return void a.remove();r="";for(var i=0;i<d.settings.toggleFields.length;++i)r+=e.templates.toggleSelectOption(t[i],parseInt(t[i].id)===l);o.html(r),n.push({fieldId:l,compare:a.find(".reasonsRuleCompare select").val(),value:a.find(".reasonsRuleValue *:input:first").val()})}),0===n.length?void i.remove():void d.settings.rules.push(n)}),this.settings.onChange&&this.settings.onChange()}},{key:"getConditionals",value:function(){return!!(this.settings.rules&&this.settings.rules.length>0)&&this.settings.rules}},{key:"addStatement",value:function(e){e=$.extend({rules:!1},e);var t=this.$statement.clone(!0),n=e.rules;if(this.$ui.append(t),n)for(var i=0;i<n.length;++i)this.addRule($.extend({target:t},n[i]));else this.addRule({target:t});return t}},{key:"addRule",value:function(e){e=$.extend({fieldId:null,compare:null,value:null},e);var t=this.$rule.clone(!0),n=e.target||this.$ui.find(".reasonsStatement:last"),i=e.fieldId,s=e.compare,a=e.value;return i&&t.find(".reasonsRuleToggleField select").val(i),n.length>0&&(n.find(".reasonsRules:first").append(t),t.find(".reasonsRuleToggleField select").trigger("change"),s&&t.find(".reasonsRuleCompare select").val(s),a&&t.find(".reasonsRuleValue *:input:first").val(a),this.settings.onChange&&this.settings.onChange(),t)}},{key:"onAddRuleBtnClick",value:function(e){e.preventDefault();var t=$(e.currentTarget).parents(".reasonsStatement");this.addRule({target:t})}},{key:"onRemoveRuleBtnClick",value:function(e){e.preventDefault();var t=$(e.currentTarget),n=t.parents(".reasonsRule");n.remove(),this.render()}},{key:"onAddStatementBtnClick",value:function(e){e.preventDefault(),this.addStatement()}},{key:"onRuleToggleFieldChange",value:function(t){t.preventDefault();var n=$(t.currentTarget),i=n.parents(".reasonsRule"),s=i.find(".reasonsRuleValue"),a=n.val(),o=this.getToggleFieldById(a),l=o.type,r=o.settings,d="";switch(console.log(">>>",l),l){case"Lightswitch":d=e.templates.select([{"true":Craft.t("on")},{"false":Craft.t("off")}]);break;case"Dropdown":case"MultiSelect":case"Checkboxes":case"RadioButtons":case"ButtonBox_Buttons":case"ButtonBox_Colours":case"ButtonBox_TextSize":case"ButtonBox_Width":for(var u,c=r.options,f=[],p=0;p<c.length;++p)u={},u[c[p].value]=c[p].label,f.push(u);d=e.templates.select(f,"MultiSelect"===l||"Checkboxes"===l);break;case"Number":d=e.templates.number(r);break;case"ButtonBox_Stars":for(var u,h=parseInt(r.numStars)+1,f=[],p=0;p<h;++p)u={},u[""+p]=p,f.push(u);d=e.templates.select(f);break;case"PositionSelect":for(var u,c=r.options,f=[],p=0;p<c.length;++p)u={},u[c[p]]=c[p].charAt(0).toUpperCase()+c[p].slice(1),f.push(u);d=e.templates.select(f);break;case"Entries":case"Categories":case"Tags":case"Assets":case"Users":case"Calendar_Event":var f=[{"null":Craft.t("Empty").toLowerCase()},{notnull:Craft.t("Not empty").toLowerCase()}];d=e.templates.select(f);break;default:d=e.templates.input(r)}s.html(d)}},{key:"onRuleCompareChange",value:function(e){e.preventDefault()}},{key:"onRuleValueChange",value:function(e){e.preventDefault()}}]),e}());l.settings={fieldId:null,toggleFields:null,rules:null,onChange:null},l.templates={select:function(e,t){for(var n,i,s,a=[],o=0;o<e.length;++o)n=e[o],i=Object.keys(n)[0],s=n[i],a.push('<option value="'+i+'">'+s+"</option>");return'<div class="'+(t?"multiselect":"select")+'"><select'+(t?" multiple":"")+">"+a.join("")+"</select></div>"},toggleSelectOption:function(e,t){return'<option value="'+e.id+'" data-type="'+e.type+'"'+(t?" selected":"")+">"+e.name+"</option>"},number:function(e){return'<div class="input"><input class="text" type="number" value="0" min="'+e.min+'" max="'+e.max+'" autocomplete="off"></div>'},input:function r(e){var r="";return e=$.extend({initialRows:4,placeholder:"",multiline:!1},e),r+="1"===e.multiline?'<textarea rows="'+e.initialRows+'" placeholder="'+e.placeholder+'" autocomplete="off"></textarea>':'<input class="text" type="text" size="20" value="" placeholder="'+e.placeholder+'" autocomplete="off">','<div class="input">'+r+"</div>"},builderUi:function(){return'<div class="reasonsBuilderUi"><div class="wrapper"><div class="heading"><span>'+Craft.t("Show this field if")+'</span></div><div class="reasonsBuilder"><div class="reasonsStatement"><span class="delimiter">'+Craft.t("or")+'</span><div class="reasonsRules"><div class="reasonsRule"><div class="reasonsRuleParams"><div class="select reasonsRuleToggleField"><select /></div><div class="select reasonsRuleCompare"><select><option value="==">'+Craft.t("is equal to")+'</option><option value="!=">'+Craft.t("is not equal to")+'</option></select></div><div class="reasonsRuleValue" /></div><div class="reasonsRuleAmend"><a class="delete icon reasonsRemoveRule" title="'+Craft.t("Remove rule")+'"></a><a class="add icon reasonsAddRule" title="'+Craft.t("and")+'"></a></div><span class="reasonsRuleLead">'+Craft.t("and")+'</span></div></div></div></div><div class="reasonsAdd"><a class="btn reasonsAddStatement">'+Craft.t("Add rules")+'</a></div></div><div class="reasonsMessage"></div></div>'}},t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(11),l=(i(o),function(){function e(t,n){s(this,e),this.$el=$(e.template),this.$builder=t.get().appendTo(this.$el.find(".body")),this.settings=$.extend({},n),this.modal=new Garnish.Modal(this.$el,{resizable:!0,onHide:this.settings.onHide.bind(this)}),this.$el.on("click",".close",this.hide.bind(this))}return a(e,[{key:"hide",value:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.modal.hide()}},{key:"destroy",value:function(){this.modal.destroy(),delete this.modal,this.$builder.remove(),delete this.$builder,delete this.settings,delete this.$el}},{key:"onHide",value:function(){this.settings.onHide&&this.settings.onHide(),this.destroy()}}]),e}());l.template='<div class="modal elementselectormodal reasonsModal"><div class="body" /><div class="footer"><div class="buttons rightalign first"><div class="btn close submit">Done</div></div></div></div>',t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(1),l=i(o),r=n(11),d=i(r),u=(n(17),function(){function e(t){s(this,e);var n=t.prototype,i=n.init,a=this;n.init=function(){i.apply(this,arguments),a.init(this)}}return a(e,[{key:"init",value:function(e){this.configurator=e;for(var t in this.configurator.blockTypes)this.initBlockType(this.configurator.blockTypes[t])}},{key:"update",value:function(){}},{key:"initBlockType",value:function(e){e._reasons={$input:$('<input type="hidden" name="types[Matrix][blockTypes]['+e.id+'][_reasonsPlugin]" value="" />').appendTo(e.$item)};for(var t in e.fields)this.initField(e.fields[t]);return e}},{key:"destroyBlockType",value:function(){}},{key:"updateBlockType",value:function(){}},{key:"onBlockTypeAdded",value:function(){}},{key:"onBlockTypeRemoved",value:function(){}},{key:"initField",value:function(e){console.log(e,e.id);var t=this.getToggleFieldsForField(e),n=this.getConditionalsForField(e),i=new d["default"]({fieldId:e.id,toggleFields:t,rules:n,onChange:this.onConditionalsBuilderChange.bind(e)});e.$fieldSettingsContainer.children("a.delete:last").before($("<div><hr /></div>").prepend(i.get())),e._reasons={builder:i}}},{key:"destroyField",value:function(){}},{key:"onFieldTypeChange",value:function(e){}},{key:"onFieldAdded",value:function(){}},{key:"onFieldRemoved",value:function(){}},{key:"onConditionalsBuilderChange",value:function(){}},{key:"getToggleFieldsForField",value:function(e){var t=l["default"].getToggleFieldTypes(),n=e.blockType,i=[],s=void 0;for(var a in n.fields)s=n.fields[a],s.id!==e.id&&t.indexOf(s.selectedFieldType)>-1&&i.push(this.getToggleFieldDataFromField(s));return i}},{key:"getToggleFieldDataFromField",value:function(e){var t=e.selectedFieldType;return{id:e.id,handle:e.$handleInput.val(),name:e.$nameInput.val(),type:t,contentAttribute:null,settings:this.getToggleFieldSettingsFromField(e)}}},{key:"getToggleFieldSettingsFromField",value:function(e){return"Dropdown"===e.selectedFieldType,null}},{key:"getConditionalsForField",value:function(){return null}}]),e}());t["default"]=u},,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function s(){n(this,s),console.log("form parser init")};t["default"]=i},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function s(){n(this,s),console.log("matrix parser init")};t["default"]=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OPTION_BASED_FIELDTYPES=["Dropdown","MultiSelect","Checkboxes","RadioButtons","ButtonBox_Buttons","ButtonBox_Colours","ButtonBox_TextSize","ButtonBox_Width"]}]);
//# sourceMappingURL=reasons.js.map